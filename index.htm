<!-- Add to docs/working.html -->
<script>
// Add more DAW features to the working version
let tracks = [];
let isRecording = false;
let metronomeInterval;

function addTrack() {
    const track = {
        id: tracks.length + 1,
        name: `Track ${tracks.length + 1}`,
        volume: 75,
        pan: 0,
        muted: false,
        solo: false
    };
    tracks.push(track);
    updateTrackDisplay();
}

function updateTrackDisplay() {
    const trackContainer = document.getElementById('tracks');
    trackContainer.innerHTML = tracks.map(track => `
        <div class="track">
            <h4>${track.name}</h4>
            <button onclick="toggleMute(${track.id})">${track.muted ? 'ğŸ”‡' : 'ğŸ”Š'}</button>
            <button onclick="toggleSolo(${track.id})">${track.solo ? 'â­' : 'â—‹'}</button>
            <label>Vol: <input type="range" min="0" max="100" value="${track.volume}" 
                   onchange="setTrackVolume(${track.id}, this.value)"></label>
        </div>
    `).join('');
}

function toggleMetronome() {
    if (metronomeInterval) {
        clearInterval(metronomeInterval);
        metronomeInterval = null;
        document.getElementById('metronome').textContent = 'ğŸ”‡ Metronome: OFF';
    } else {
        const interval = 60000 / 120; // 120 BPM
        metronomeInterval = setInterval(() => {
            playClick();
        }, interval);
        document.getElementById('metronome').textContent = 'ğŸ”Š Metronome: ON';
    }
}

function playClick() {
    const osc = audioContext.createOscillator();
    const gain = audioContext.createGain();
    osc.connect(gain);
    gain.connect(audioContext.destination);
    osc.frequency.setValueAtTime(1000, audioContext.currentTime);
    gain.gain.setValueAtTime(0.1, audioContext.currentTime);
    gain.gain.exponentialRampToValueAtTime(0.001, audioContext.currentTime + 0.1);
    osc.start();
    osc.stop(audioContext.currentTime + 0.1);
}
</script>
